webpackJsonp([9],{jPwu:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("2S+2"),a={data:function(){return{modal1:!1,modal2:!1,total:12,loading:!0,saveLoading:!1,formTop:{},tableHeader:[{title:"图片",slot:"img"},{title:"名称",slot:"name"},{title:"所需积分",slot:"integral"},{title:"描述",slot:"description"},{title:"操作",slot:"action"}],tableData:[],editIndex:-1,currentPage:1,pageSize:10,editObject:{"shop.img":"","shop.integral":"","shop.description":"","shop.name":"","shop.id":""}}},created:function(){this.getTableData({currentPage:1})},methods:{addNewGift:function(){var t=this;Object(o.b)(this.formTop).then(function(e){for(var n in t.formTop)t.formTop.hasOwnProperty(n)&&(t.formTop[n]="");t.getTableData({currentPage:t.currentPage}),t.$Message.success("添加成功")})},getTableData:function(t){var e=this;t.pageSize=this.pageSize,this.loading=!0,Object(o.h)(t).then(function(t){console.log(t);var n=t.data.data.data;e.tableData=n.filter(function(t){if(!t.deleted)return t}),e.total=t.data.data.total,e.loading=!1})},handleDelete:function(t,e){var n=this;confirm("确认要删除吗？")&&Object(o.e)({"shop.id":t.id}).then(function(t){200===t.data.code&&(n.getTableData({currentPage:n.currentPage}),n.$Message.success("删除成功"))})},handleEdit:function(t,e){this.editObject["shop.img"]=t.img,this.editObject["shop.integral"]=t.integral,this.editObject["shop.description"]=t.description,this.editObject["shop.name"]=t.name,this.editObject["shop.id"]=t.id,this.editIndex=e},handleSave:function(t){var e=this;this.saveLoading=!0,Object(o.q)(this.editObject).then(function(n){console.log(n),e.tableData[t].img=e.editObject["shop.img"],e.tableData[t].integral=e.editObject["shop.integral"],e.tableData[t].description=e.editObject["shop.description"],e.tableData[t].name=e.editObject["shop.name"],e.tableData[t].id=e.editObject["shop.id"],e.editObject={},e.editIndex=-1,e.saveLoading=!1,e.$Message.success("保存成功")})},onChange:function(t){this.currentPage=t,this.getTableData({currentPage:t})}}},i={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container my-shadow box"},[n("div",{staticStyle:{display:"flex","justify-content":"space-between","margin-bottom":"30px"}},[n("h2",[t._v("商城管理")]),t._v(" "),n("Button",{attrs:{type:"primary"},on:{click:function(e){t.modal1=!0}}},[t._v("新增")])],1),t._v(" "),n("Table",{attrs:{columns:t.tableHeader,data:t.tableData,border:"",loading:t.loading},scopedSlots:t._u([{key:"img",fn:function(e){var o=e.row,a=e.index;return[t.editIndex===a?n("Input",{attrs:{type:"text"},model:{value:t.editObject["shop.img"],callback:function(e){t.$set(t.editObject,"shop.img",e)},expression:"editObject['shop.img']"}}):n("Poptip",{attrs:{trigger:"hover",placement:"bottom-start",transfer:""}},[n("span",{staticStyle:{"text-decoration":"underline",cursor:"pointer",color:"#52B2EF"}},[t._v(t._s(o.name))]),t._v(" "),n("div",{attrs:{slot:"content"},slot:"content"},[n("img",{attrs:{src:o.img,alt:"图片加载失败"}})])])]}},{key:"name",fn:function(e){var o=e.row,a=e.index;return[t.editIndex===a?n("Input",{attrs:{type:"text"},model:{value:t.editObject["shop.name"],callback:function(e){t.$set(t.editObject,"shop.name",e)},expression:"editObject['shop.name']"}}):n("span",[t._v(t._s(o.name))])]}},{key:"integral",fn:function(e){var o=e.row,a=e.index;return[t.editIndex===a?n("Input",{attrs:{type:"text"},model:{value:t.editObject["shop.integral"],callback:function(e){t.$set(t.editObject,"shop.integral",e)},expression:"editObject['shop.integral']"}}):n("span",[t._v(t._s(o.integral))])]}},{key:"description",fn:function(e){var o=e.row,a=e.index;return[t.editIndex===a?n("Input",{attrs:{type:"text"},model:{value:t.editObject["shop.description"],callback:function(e){t.$set(t.editObject,"shop.description",e)},expression:"editObject['shop.description']"}}):n("span",[t._v(t._s(o.description))])]}},{key:"action",fn:function(e){var o=e.row,a=e.index;return[t.editIndex===a?n("div",[n("Button",{attrs:{loading:t.saveLoading},on:{click:function(e){return t.handleSave(a)}}},[t._v("保存")]),t._v(" "),n("Button",{on:{click:function(e){t.editIndex=-1}}},[t._v("取消")])],1):n("div",[n("Button",{on:{click:function(e){return t.handleEdit(o,a)}}},[t._v("编辑")]),t._v(" "),n("Button",{staticStyle:{color:"red"},on:{click:function(e){return t.handleDelete(o,a)}}},[t._v("删除")])],1)]}}])}),t._v(" "),n("Page",{staticStyle:{"margin-top":"30px",float:"right"},attrs:{total:t.total},on:{"on-change":t.onChange}}),t._v(" "),n("Modal",{attrs:{title:"添加新商品"},on:{"on-ok":t.addNewGift,"on-cancel":t.cancel},model:{value:t.modal1,callback:function(e){t.modal1=e},expression:"modal1"}},[n("Form",{attrs:{model:t.formTop,"label-position":"right","label-width":40}},[n("FormItem",{attrs:{label:"名称"}},[n("Input",{model:{value:t.formTop["shop.name"],callback:function(e){t.$set(t.formTop,"shop.name",e)},expression:"formTop['shop.name']"}})],1),t._v(" "),n("FormItem",{attrs:{label:"积分"}},[n("Input",{model:{value:t.formTop["shop.integral"],callback:function(e){t.$set(t.formTop,"shop.integral",e)},expression:"formTop['shop.integral']"}})],1),t._v(" "),n("FormItem",{attrs:{label:"图片"}},[n("Input",{model:{value:t.formTop["shop.img"],callback:function(e){t.$set(t.formTop,"shop.img",e)},expression:"formTop['shop.img']"}})],1),t._v(" "),n("FormItem",{attrs:{label:"描述"}},[n("Input",{attrs:{type:"textarea"},model:{value:t.formTop["shop.description"],callback:function(e){t.$set(t.formTop,"shop.description",e)},expression:"formTop['shop.description']"}})],1)],1)],1)],1)},staticRenderFns:[]};var s=n("VU/8")(a,i,!1,function(t){n("z2SP")},"data-v-5f89678d",null).exports;e.default=s},z2SP:function(t,e){}});
//# sourceMappingURL=9.53773313ce1d5e7d6fd7.js.map